const { Client, GatewayIntentBits } = require("discord.js");
const http = require("http");

// ===== Discord Client =====
const client = new Client({
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMessages,
    GatewayIntentBits.MessageContent,
    GatewayIntentBits.GuildVoiceStates,
    GatewayIntentBits.GuildMembers,
  ],
});

// ===== è¨­å®š =====
const VC_CHANNEL_ID = "1434447254735032353";
const WATCH_TEXT_CHANNEL_ID = "1434447254735032352";
const TARGET_TEXT_CHANNEL_ID = "1442449125550592081";

// ===== ãƒ€ãƒŸãƒ¼HTTPï¼ˆNorthflank Health Checkç”¨ï¼‰=====
http.createServer((req, res) => {
  res.writeHead(200);
  res.end("Bot running");
}).listen(process.env.PORT || 3000);

// ===== èµ·å‹•ç¢ºèª =====
client.once("ready", () => {
  console.log(`âœ… Logged in as ${client.user.tag}`);
});

// ===== ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç›£è¦– =====
client.on("messageCreate", async (message) => {
  if (message.author.bot || !message.guild) return;
  if (message.channel.id !== WATCH_TEXT_CHANNEL_ID) return;

  const member = message.guild.members.cache.get(message.author.id);
  if (!member?.voice?.channel) return;
  if (member.voice.channel.id !== VC_CHANNEL_ID) return;

  const targetChannel = message.guild.channels.cache.get(TARGET_TEXT_CHANNEL_ID);
  if (!targetChannel) return;

  targetChannel.send({
    content: `ðŸŽ¤ **${member.displayName}**\n${message.content}`,
  });
});

// ===== ãƒ­ã‚°ã‚¤ãƒ³ =====
client.login(process.env.TOKEN);

BOT_TOKEN = < 1442439044863758337 >
